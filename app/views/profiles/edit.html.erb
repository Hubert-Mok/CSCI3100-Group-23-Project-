<% content_for :title, "Edit Profile – CUHK Marketplace" %>

<div class="form-page">
  <div class="form-page-header">
    <h1>Edit Profile</h1>
    <p>Update your account information.</p>
  </div>

  <% if @user.errors.any? %>
    <div class="error-messages">
      <p><strong><%= pluralize(@user.errors.count, "error") %> prevented your profile from being saved:</strong></p>
      <ul>
        <% @user.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= form_with model: @user, url: profile_path, method: :patch, class: "auth-form" do |f| %>
    <div class="form-group">
      <%= f.label :username, "Username" %>
      <%= f.text_field :username, required: true, autocomplete: "username" %>
    </div>

    <div class="form-group">
      <%= f.label :email, "Email" %>
      <%= f.email_field :email, required: true, autocomplete: "email" %>
    </div>

    <div class="form-group">
      <%= f.label :college_affiliation, "College" %>
      <%= f.select :college_affiliation,
            options_for_select(User::COLLEGES, @user.college_affiliation),
            { include_blank: "Select your college" },
            { required: true } %>
    </div>

    <div class="form-group form-group-static">
      <span class="static-label">CUHK Student ID</span>
      <span class="static-value"><%= @user.cuhk_id %></span>
      <span class="static-hint">Student ID cannot be changed after registration.</span>
    </div>

    <%= f.submit "Save Changes", class: "btn-primary" %>
  <% end %>

  <p class="auth-footer"><%= link_to "← Cancel", profile_path %></p>
</div>
